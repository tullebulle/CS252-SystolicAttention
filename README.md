# 2D-Systolic-Array-Multiplier

This repository implements a two dimensional systolic array that can be
configured to multiply 2 square matrices of 2 < dimensions < 17.

The `rtl` sub-directory contains the RTL written in System Verilog and the `tb`
sub-directory contains the test bench written in C++ and simulated using
Verilator.

## TL;DR

Requirements: `Verilator` and `GNU Make`.

To simulate the TB generating random NxN input matrices, driving the DUT ports
and displaying the result matrix generated by the DUT:

1. Clone the repository.

2. Run the simulation:

By default the RTL and TB are configured to a matrix size of 4x4.

To modify the default matrix size: `cd rtl`, open `topSystolicArray.sv` and
modify the paramater `N`. And, `cd tb`, open `tb_topSystolicArray.sv` and modify
the macro `N`.

```
cd tb && make all
```

## Introduction

### Systolic architectures

(describe and explain seminal paper: "Why Systolic Architectures?": https://www.cse.wustl.edu/~roger/560M.f17/01653825.pdf)

### Existing implementations

(describe Google's TPU. Blog: https://cloud.google.com/blog/products/ai-machine-learning/an-in-depth-look-at-googles-first-tensor-processing-unit-tpu. Paper: https://arxiv.org/pdf/1704.04760.pdf)


## Verification Outline

A basic C++ test bench consisting of several functions to implement a specific
task was created. The test outline is show below:

0. Assert the asynchronous reset.

Loop {

  1. Assert `i_validInput`
  2. Create random NxN matrices
  3. Drive the input ports `i_a` and `i_b` with these matrices
  4. When `o_validResult` is asserted
  5. Calculate the expected result matrix
  6. Verify that `o_c` is equal to the result Attention matrix, if it isn't raise an error
  7. Wait for a few clock cycles
}

The simulation prints out the input matrices and the expected result matrix. If
an error occurs, the output matrix received will also be printed and the
simulation will end.

The `README.md` file in the `tb` sub-directory contains implementation specific
details.

## Acknowledgements

The repository structure was influenced by the work from the repository [2D-Systolic-Array-Multiplier](https://github.com/tms4517/2D-Systolic-Array-Multiplier). Their System Verilog code for output-stationary systolic arrays was a great starting point. Also, I still use his implementation of the testbench. Thank you!

